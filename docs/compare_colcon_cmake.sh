#!/bin/bash
# Colcon vs CMake ç¼–è¯‘å¯¹æ¯”æ¼”ç¤º

echo "=============================================="
echo "  Colcon vs CMake ç¼–è¯‘å†…å®¹å¯¹æ¯”æ¼”ç¤º"
echo "=============================================="

# é¢œè‰²å®šä¹‰
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
RED='\033[0;31m'
NC='\033[0m'

echo ""
echo -e "${BLUE}ðŸ“‚ 1. Colcon ç¼–è¯‘çš„ç›®å½•ç»“æž„${NC}"
echo "=============================================="
echo "å½“ä½ è¿è¡Œ: colcon build"
echo ""
echo "ç”Ÿæˆçš„ç›®å½•ç»“æž„:"
echo "example/"
echo "â”œâ”€â”€ build/                    â† æž„å»ºä¸´æ—¶æ–‡ä»¶"
echo "â”‚   â””â”€â”€ unitree_ros2_example/ â† æ¯ä¸ªåŒ…ä¸€ä¸ªå­ç›®å½•"
echo "â”‚       â”œâ”€â”€ CMakeCache.txt"
echo "â”‚       â”œâ”€â”€ Makefile"
echo "â”‚       â”œâ”€â”€ *.o æ–‡ä»¶"
echo "â”‚       â””â”€â”€ å¯æ‰§è¡Œæ–‡ä»¶ (ä¸´æ—¶)"
echo "â”‚"
echo "â”œâ”€â”€ install/                  â† æœ€ç»ˆå®‰è£…ä½ç½® â­"
echo "â”‚   â”œâ”€â”€ setup.bash            â† çŽ¯å¢ƒè„šæœ¬"
echo "â”‚   â””â”€â”€ unitree_ros2_example/"
echo "â”‚       â”œâ”€â”€ lib/              â† æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨è¿™é‡Œ"
echo "â”‚       â”‚   â””â”€â”€ unitree_ros2_example/"
echo "â”‚       â”‚       â”œâ”€â”€ read_low_state"
echo "â”‚       â”‚       â””â”€â”€ custom_sensor_reader"
echo "â”‚       â””â”€â”€ share/            â† é…ç½®æ–‡ä»¶"
echo "â”‚"
echo "â””â”€â”€ src/                      â† æºä»£ç "
echo ""

echo -e "${BLUE}ðŸ“‚ 2. çº¯ CMake ç¼–è¯‘çš„ç›®å½•ç»“æž„${NC}"
echo "=============================================="
echo "å½“ä½ è¿è¡Œ: mkdir build && cd build && cmake .. && make"
echo ""
echo "ç”Ÿæˆçš„ç›®å½•ç»“æž„:"
echo "my_project/"
echo "â”œâ”€â”€ build/                    â† æ‰€æœ‰æž„å»ºæ–‡ä»¶éƒ½åœ¨è¿™é‡Œ"
echo "â”‚   â”œâ”€â”€ CMakeCache.txt"
echo "â”‚   â”œâ”€â”€ Makefile"
echo "â”‚   â”œâ”€â”€ *.o æ–‡ä»¶"
echo "â”‚   â””â”€â”€ my_program            â† å¯æ‰§è¡Œæ–‡ä»¶ç›´æŽ¥åœ¨è¿™"
echo "â”‚"
echo "â””â”€â”€ src/                      â† æºä»£ç "
echo ""

echo -e "${YELLOW}ðŸ” 3. å…³é”®åŒºåˆ«${NC}"
echo "=============================================="
echo ""
echo -e "${GREEN}âœ“ Colcon æ–¹å¼:${NC}"
echo "  - ç¼–è¯‘äº§ç‰©åœ¨: build/package_name/"
echo "  - å¯æ‰§è¡Œæ–‡ä»¶å®‰è£…åˆ°: install/package_name/lib/"
echo "  - è‡ªåŠ¨ç”ŸæˆçŽ¯å¢ƒè„šæœ¬: install/setup.bash"
echo "  - æ”¯æŒå¤šä¸ªåŒ…çš„ä¾èµ–å…³ç³»"
echo ""
echo -e "${GREEN}âœ“ CMake æ–¹å¼:${NC}"
echo "  - ç¼–è¯‘äº§ç‰©åœ¨: build/"
echo "  - å¯æ‰§è¡Œæ–‡ä»¶ç›´æŽ¥åœ¨: build/"
echo "  - éœ€è¦æ‰‹åŠ¨è®¾ç½®çŽ¯å¢ƒå˜é‡"
echo "  - é€‚åˆå•ä¸€é¡¹ç›®"
echo ""

echo -e "${RED}âš ï¸  4. ä¸ºä»€ä¹ˆä¸è¦æ··ç”¨?${NC}"
echo "=============================================="
echo ""
echo "âŒ å¦‚æžœåœ¨ Colcon é¡¹ç›®ä¸­ç›´æŽ¥ç”¨ CMake:"
echo ""
echo "cd example/build/unitree_ros2_example"
echo "cmake ../../src"
echo "make"
echo ""
echo "ä¼šå¯¼è‡´:"
echo "  1. è·¯å¾„æ··ä¹± - Colcon æœŸæœ›çš„è·¯å¾„è¢«ç ´å"
echo "  2. å®‰è£…å¤±è´¥ - æ–‡ä»¶ä¸åœ¨ install/ ç›®å½•"
echo "  3. çŽ¯å¢ƒå˜é‡é”™è¯¯ - setup.bash å¤±æ•ˆ"
echo "  4. ä¾èµ–é—®é¢˜ - ROS2 ä¾èµ–æ— æ³•æ­£ç¡®è§£æž"
echo ""

echo -e "${GREEN}âœ… 5. æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼${NC}"
echo "=============================================="
echo ""
echo "å¯¹äºŽ ROS2 é¡¹ç›® (unitree_ros2):"
echo ""
echo -e "  ${BLUE}cd /home/weeq/unitree_ros2/example${NC}"
echo -e "  ${BLUE}colcon build${NC}"
echo -e "  ${BLUE}source install/setup.bash${NC}"
echo -e "  ${BLUE}ros2 run unitree_ros2_example custom_sensor_reader${NC}"
echo ""
echo "ä¸è¦è¿è¡Œ:"
echo -e "  ${RED}cd build/unitree_ros2_example${NC}"
echo -e "  ${RED}cmake ../../src${NC}  âŒ"
echo ""

echo -e "${BLUE}ðŸ“ 6. ç¼–è¯‘äº§ç‰©æ˜¯å¦ç›¸åŒ?${NC}"
echo "=============================================="
echo ""
echo "ç†è®ºä¸Š: ç›¸åŒ"
echo "  - éƒ½æ˜¯ ELF å¯æ‰§è¡Œæ–‡ä»¶"
echo "  - éƒ½é“¾æŽ¥ç›¸åŒçš„åº“"
echo "  - éƒ½èƒ½è¿è¡Œ"
echo ""
echo "å®žè·µä¸­: ä½ç½®å’Œä½¿ç”¨æ–¹å¼ä¸åŒ"
echo "  - Colcon: install/lib/unitree_ros2_example/program"
echo "  - CMake:  build/program"
echo ""

echo -e "${YELLOW}ðŸ’¡ 7. æŸ¥çœ‹å®žé™…ç¼–è¯‘çš„æ–‡ä»¶${NC}"
echo "=============================================="
echo ""

if [ -d "/home/weeq/unitree_ros2/example/build/unitree_ros2_example" ]; then
    echo "Colcon ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶:"
    ls -lh /home/weeq/unitree_ros2/example/build/unitree_ros2_example/*.* 2>/dev/null | grep -E "rwx" | head -5
    echo ""
fi

if [ -d "/home/weeq/unitree_ros2/example/install/unitree_ros2_example/lib" ]; then
    echo "Colcon å®‰è£…çš„å¯æ‰§è¡Œæ–‡ä»¶:"
    ls -lh /home/weeq/unitree_ros2/example/install/unitree_ros2_example/lib/unitree_ros2_example/ 2>/dev/null | head -5
    echo ""
fi

echo ""
echo -e "${GREEN}========================================${NC}"
echo -e "${GREEN}æ€»ç»“: åœ¨ ROS2 é¡¹ç›®ä¸­,${NC}"
echo -e "${GREEN}å§‹ç»ˆä½¿ç”¨ colcon build!${NC}"
echo -e "${GREEN}========================================${NC}"
