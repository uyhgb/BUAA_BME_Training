# 步态推理节点
位于robot_ws\src\exoskel_control_py\exoskel_control_py\gait_inference_node.py
可调参
```python
        # 2. 助力参数
        self.ASSIST_PEAK_PHASE = 0.60
        self.PHASE_LEAD = 0.05
        self.ASSIST_WIDTH = 0.10
        self.MAX_TORQUE = 5.0  # 稍微给大一点，因为我们有安全锁了
        self.CENTER_PHASE = self.ASSIST_PEAK_PHASE - self.PHASE_LEAD
        self.WINDOW_SIZE = 10

        # === 安全阈值 ===
        # 静止检测阈值 (你原本的参数)
        self.STATIC_VAR_THRES = 50.0  
        # 【新增】相位硬锁：低于此相位强制 0 力矩，防止支撑相误触
        self.PHASE_GATE_THRES = 0.45  
```

这些参数共同决定了外骨骼机器人**“在什么时候助力”**、**“助力多久”**以及**“助力多强”**。它们是连接 SVM 步态识别算法与物理电机输出的核心桥梁。

以下是 `gait_inference_node.py` 中这些参数的具体物理意义和对体验的影响：

### 1. `self.ASSIST_PEAK_PHASE = 0.60`（理论助力峰值相位）

* **物理意义**：定义了在人的一个步态周期中，你最希望在哪个点获得最大的力量支持。
* **背景**：在标准步态中，（即 ）通常是**脚尖离地（Toe-off）**瞬间，这是摆动相的开始，也是人体最需要助力来“提腿”的时刻。
* **影响**：如果你觉得助力太靠后（腿已经抬起来了才给力），可以调小这个值（如 ）。

### 2. `self.PHASE_LEAD = 0.05`（相位提前量）

* **物理意义**：用于补偿系统延迟（包括传感器采集、SVM 推理、数据传输和电机力矩建立的时间）。
* **影响**：如果系统总延迟约 ，而一个人迈一步约 ，那么延迟就占了  个相位。通过设置提前量，让算法提前开始发力，从而使实际助力峰值正好落在  处。
* **调整**：如果被试者觉得助力“慢了”，应增大这个值（如 ）。

### 3. `self.ASSIST_WIDTH = 0.10`（助力宽度/持续时间）

* **物理意义**：这是高斯分布曲线（钟形曲线）的**标准差 ()**。它决定了助力脉冲的“肥胖”程度。
* **影响**：
* **数值小（如 ）**：助力非常短促，感觉像被“踢”了一下。
* **数值大（如 ）**：助力非常平缓且持久，感觉是被“推”着走。


* **建议**：如果觉得力量不够饱和，可以适当调大。

### 4. `self.MAX_TORQUE = 5.0`（最大助力矩）

* **物理意义**：高斯曲线的最高点，即电机能输出的最大辅助力矩，单位为 。
* **影响**：直接决定了助力的“劲儿”有多大。
* **限制**：受限于 `motor_driver_node.py` 里的硬件限幅和电机的物理极限。

### 5. `self.CENTER_PHASE = self.ASSIST_PEAK_PHASE - self.PHASE_LEAD`（实际计算中心）

* **物理意义**：这是算法内部真正使用的“发力中心点”。
* **逻辑**：如果要在  达到顶峰，考虑到  的延迟，算法会在相位到达  时就输出最大指令。

### 6. `self.WINDOW_SIZE = 10`（特征窗口大小）

* **物理意义**：SVM 推理时观察“过去多久”的数据。它决定了算法的“记忆长度”。
* **背景**：代码会保存最近  帧 IMU 数据（如果是 ，则为过去  秒），计算这  帧的平均值、标准差和趋势作为特征输入。
* **影响**：
* **太大**：识别会很稳，但会有明显的感官延迟，且特征会被“抹平”。
* **太小**：响应极快，但容易受传感器噪声干扰导致误判或力矩抖动。



---

### 💡 调参口诀（快速回忆）

* **想提前助力**：调大 `PHASE_LEAD`。
* **想助力更猛**：调大 `MAX_TORQUE`。
* **想助力更久**：调大 `ASSIST_WIDTH`。
* **想防误触发**：调大 `WINDOW_SIZE` 或静止检测阈值。



# 电机驱动节点
位于robot_ws\src\exoskel_control_py\exoskel_control_py\motor_driver_node.py
可调参
```python
        # 柔顺控制参数 (源自之前的静音测试)
        self.TARGET_KP = 0.0   # 必须为0！否则会像皮筋一样把人拉回0度
        self.TARGET_KD = 0.05  # 0.05 是之前测试出的最佳静音阻尼
        self.MAX_TORQUE = 10.0 # 物理保护限幅
```
柔顺控制参数最好别改，不然会有很大噪音
此节点主要是有一个物理限幅参数`self.MAX_TORQUE`，改这个就行